<!DOCTYPE html>
<html>
<head>
    <title>epgo</title>
    <link href='https://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="css/site.css">
</head>
<body>
<header>
<a href="http://library.caltech.edu" title="link to Caltech Library Homepage"><img src="assets/liblogo.gif" alt="Caltech Library logo"></a>
</header>
<nav>
<ul>
<li><a href="/">Home</a></li>
<li><a href="./">README</a></li>
<li><a href="license.html">LICENSE</a></li>
<li><a href="install.html">INSTALL</a></li>
<li><a href="epgo.html">epgo</a></li>
<li><a href="epgo-genpages.html">epgo-genpages</a></li>
<li><a href="https://github.com/caltechlibrary/epgo">Github</a></li>
</ul>

</nav>

<section>
<h1>Overview</h1>

<p>E-Prints produces a list of recently added items to the repository but doesn&rsquo;t provide a feed of items by publication dates.
The epgo command line utility provides a way to generate that list by leveraging E-Prints REST API.</p>

<h2>epgo functions</h2>

<ul>
<li>New() - returns an new API structure</li>
<li>ListEPrintsURI() - returns a list of eprint URI from the REST API</li>
<li>GetEPrint() - returns an eprint record by URI from the REST API</li>
<li>ListURI() - return a list of eprint URI from the database</li>
<li>Get() - returns an eprint record by URI from the database</li>
<li>ExportEPrints() - exports the contents from the EPrint REST API into a database with a publication dates index</li>
<li>GetAllRecordIDs() - return an array of all record ids</li>
<li>GetAllRecords() - return an array of all eprint records</li>
<li>GetPublishedRecords() - returns an array of records with a date type of &ldquo;published&rdquo; from the database

<ul>
<li>IsPublished is &ldquo;pub&rdquo;</li>
<li>Date Type is &ldquo;publish&rdquo;</li>
</ul></li>
<li>GetPublishedArticles() - recently published articles

<ul>
<li>Type is &ldquo;article&rdquo;</li>
<li>IsPublished is &ldquo;pub&rdquo;</li>
<li>Date Type is &ldquo;publish&rdquo;</li>
</ul></li>
<li>GetLocalGroups() - get a list of unique local groups used in EPrints</li>
<li>GetLocalGroupRecords() - get a list of EPrint records for given Local Group</li>
<li>GetORCIDS() - get a list of unique orcid ids used in EPrints</li>
<li>GetORCIDRecords() - get a list of EPrint records for a given ORCID id</li>
<li>BuildPages() - generate a page from an EPrints (BuildSite() makes repeated calls to BuildPage())</li>
<li>BuildSite() - generates a JSON file of 25 most recently published articles, a version in RSS and one as an HTML include</li>
<li>BuildEPrintMirror() - mirror all the EPrint records in JSON form from BoltDB copy</li>
<li>RenderDocuments() - takes a basepath and records array and renders out a directory with *.rss, *.html, *.include and *.json</li>
<li>RenderEPrint() - render a mirrored eprint record</li>
</ul>

<p>Additional functions working off lists</p>

<ul>
<li>ToNames() - from a PersonList type, returns a list of names in Family, Given format</li>
<li>ToORCIDs() - from a PersonList type, return a list of ORCID ids found</li>
<li>ToISNIs() - from a PersonList type, return a list of ISNI ids found</li>
<li>ToAgencies() - from a FunderList type, return a list of agency names</li>
<li>ToGrantNumbers() - from a FunderList type, return a list of grant numbers</li>
<li>PubDate() - from a Record structure, return a publication date or empty string</li>
</ul>

<h2>epgo Search</h2>

<p>A feature that needs to be added to accessing simple and advanced search via the <em>epgo</em> library.</p>

<p>Two examples of &ldquo;search&rdquo; using <em>curl</em> for titles starting with &ldquo;flood characteristic of alluvial&rdquo;</p>

<pre><code class="language-shell">    # Basic search URL from using form
    curl &quot;$EPRINTS_URL/cgi/search/simple?screen=Search&amp;order=&amp;q_merge=ALL&amp;q=flood+characteristics+of+alluvial&amp;_action_search=Search&quot;\
    | jq 
    # Advanced Search returned as JSON (title = ??)
    curl &quot;$EPRINTS_URL/cgi/search/archive/advanced/export_caltechauthors_JSON.js?screen=Search&amp;dataset=archive&amp;_action_export=1&amp;output=JSON&amp;exp=0%7C1%7C-date%2Fcreators_name%2Ftitle%7Carchive%7C-%7Ctitle%3Atitle%3AALL%3AIN%3Aflood+characteristics+of+alluvial%7C-%7Ceprint_status%3Aeprint_status%3AANY%3AEQ%3Aarchive%7Cmetadata_visibility%3Ametadata_visibility%3AANY%3AEQ%3Ashow&amp;n=&quot;\
    | jq '{title: .[].title, uri: .[].uri}'
</code></pre>

<h2>environment vars</h2>

<ul>
<li>EPGO_API_URL - base URL for your eprints repository (e.g. <a href="http://lemurprints.local">http://lemurprints.local</a>)</li>
<li>EPGO_SITE_URL - the website url (might be the same as your eprints repository)</li>
<li>EPGO_DBNAME - the database name used in exporting or building</li>
<li>EPGO_HTDOCS - the htdocs directory where files are written in building</li>
<li>EPGO_TEMPLATES - the template directory holding the templates for building</li>
</ul>

<h2>htdocs layout</h2>

<ul>
<li>publications.<em>, articles.</em> come from EPrints</li>
<li>data.* comes from the data repository</li>
<li>FORMAT: .html, .include (html fragment), .rss, .json (as JSON document), .bib (BibTeX)</li>
<li>ORCID-OR-ISNI: if we have an ORCID use that otherwise use ISNI if available (e.g. Richard Feynman only has an ISNI but not an ORCID)

<ul>
<li>ORCID and ISNI do not collide, ORCID is a proper subset of ISNI&rsquo;s four four digit grouping</li>
</ul></li>
</ul>

<pre><code>    /index.html &lt;-- docs &amp; description of structure
    /publications.FORMAT
    /articles.FORMAT
    /data.FORMAT
    /recent/index.html &lt;-- docs describing recent 25 and data formats
    /recent/publications.FORMAT
    /recent/articles.FORMAT
    /recent/data.FORMAT
    /person/ORCID-OR-ISNI/publications.FORMAT
    /person/ORCID-OR-ISNI/articles.FORMAT
    /person/ORCID-OR-ISNI/data.FORMAT
    /person/ORCID-OR-ISNI/recent/publications.FORMAT
    /person/ORCID-OR-ISNI/recent/articles.FORMAT
    /person/ORCID-OR-ISNI/recent/data.FORMAT
    ...
    /affiliations/... &lt;-- needs to be defined around a uniqu ID (e.g. what was talked about at pidpaloosa)
    /search/?q=... &lt;-- search engine results (also available in various FORMAT)
    /tools/... &lt;-- any web based tools we invent to work with the feeds
</code></pre>

<h2>Reference materials</h2>

<ul>
<li><a href="http://wiki.eprints.org/w/API:EPrints/Apache/CRUD">Web API Docs</a>

<ul>
<li>includes example curl interactions</li>
</ul></li>
<li><a href="https://elithrar.github.io/article/approximating-html-template-inheritance/">Golang Template Tutorial</a>

<ul>
<li>page.html and page.include are the two templates needed to produce the publications feed pages</li>
</ul></li>
</ul>

</section>

<footer>
<span>&copy; 2017 <a href="http://library.caltech.edu/CLS_Copyright.htm">Caltech Library</a></span>
<address>1200 E California Blvd, Mail Code 1-32, Pasadena, CA 91125-3200</address>
<span><a href="mailto:library@caltech.edu">Email Us</a></span> 
<span>Phone: <a href="tel:+1-626-395-3405">(626)395-3405</a></span>
</footer>
</body>
</html>
